<!DOCTYPE html>
<html lang="en">
 <head>
 
 <meta charset="utf-8">
 <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
 <title>
Promises in Angular 6</title>
  
<link rel="stylesheet" href="https://jorgeancal.com/css/main.css">



<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">

<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/default.min.css">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">



<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css">
 

<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script><script defer src="https://use.fontawesome.com/releases/v5.1.0/js/all.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.63.2" /> 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-108421112-1">
</script>
 <script>
 window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments)}; gtag('js', new Date()); gtag('config', 'UA-108421112-1'); </script>
 
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
 
 

</head>

 <body class="notebook" id="notebook">
 

   <header>
     <nav class="mb-1 navbar navbar-expand-lg default-color">
       <a class="navbar-brand" href="/">
         The Green Notebook
       </a>
       <button class="navbar-toggler waves-effect waves-light" type="button" data-toggle="collapse" data-target="#mynav" >
         <i class="fas fa-bars"></i>
       </button>
       <div class="collapse navbar-collapse" id="mynav">
         <ul class="navbar-nav mr-auto">
           
            
              <li class="nav-item">
                <a class="nav-link" href="/">Home</a>
              </li>
            
              <li class="nav-item">
                <a class="nav-link" href="/about-me/">About me</a>
              </li>
            
              <li class="nav-item">
                <a class="nav-link" href="/about-this-site/">About This Site</a>
              </li>
            
           
         </ul>
         <ul class="nav navbar-nav navbar-right ml-auto">
           
            
            <li class="nav-item">
              <a class="nav-link waves-effect waves-light" href="https://github.com/jorgeancal/" target="_blank" >
                <span class="fab fa-github"></span>
              </a>
            </li>
           
            <li class="nav-item">
              <a class="nav-link waves-effect waves-light" href="https://twitter.com/jorgeancal/" target="_blank" >
                <span class="fab fa-twitter"></span>
              </a>
            </li>
           
            <li class="nav-item">
              <a class="nav-link waves-effect waves-light" href="https://www.linkedin.com/in/jorgeancal/" target="_blank" >
                <span class="fab fa-linkedin"></span>
              </a>
            </li>
           
            <li class="nav-item">
              <a class="nav-link waves-effect waves-light" href="https://www.instagram.com/jorgeancal/" target="_blank" >
                <span class="fab fa-instagram"></span>
              </a>
            </li>
           
          
         </ul>
       </div>
    </nav>
  </header>


<main class="container">
  <div class="row">
    <section class="col-12 col-lg-3 themed-grid-col">
  <div class="about">
  
  <h2>Jorge Andreu Calatayud</h2>
  <h3>IT Engineer</h3>
  <div class="avatar">
    <img class="rounded-circle" src = "/images/avatar.png" />
  </div>
  <p>Hi, My name is Jorge Andreu Calatayud and sorry for my English. I’m an IT Engineer. I studied a Bachelor of Science in Business Information Technology, with University of Wales.<p>
  <ul class="nav navbar-nav align-self-center">
    
      
       <li class="nav-item">
         <a href="https://github.com/jorgeancal/" target="_blank" >
            <span class="fab fa-github"></span>
          </a>
        </li>
      
       <li class="nav-item">
         <a href="https://twitter.com/jorgeancal/" target="_blank" >
            <span class="fab fa-twitter"></span>
          </a>
        </li>
      
       <li class="nav-item">
         <a href="https://www.linkedin.com/in/jorgeancal/" target="_blank" >
            <span class="fab fa-linkedin"></span>
          </a>
        </li>
      
       <li class="nav-item">
         <a href="https://www.instagram.com/jorgeancal/" target="_blank" >
            <span class="fab fa-instagram"></span>
          </a>
        </li>
      
    
  </ul>
<div>
</section>


    <article class="col-sm-12 col-lg-9 themed-grid-col">
      <header>
          <h1>Promises in Angular 6</h1>
      </header>
      <p class="dateFormat">
        <em>January 23, 2020</em>
      </p>
      <p>In this post you will learn about promises in Angular, which I think is a really interesting thing because you really need to know about it when you implement an API in your project and you want to have control of your application and not be crossing your fingers hoping that everything works properly.</p>
<p>Everything I just said happened to me when I started developing in Angular, which is something… I don’t recommend to anyone. Nowadays, I’m developing with another technology and I don’t want to forget anything about it so I created this post. Let’s go!
What are promises ?</p>
<p>A promise in angular is a kind of object which we use to handle asynchronous tasks. A promise has 3 stages:</p>
<ol>
<li>Pending: the promise’s result hasn’t been determined.</li>
<li>Fulfilled: the asynchronous task has been completed and it has a value.</li>
<li>Rejected: the task has failed and it has a value too, but this value is the reason why this task failed.</li>
</ol>
<p>Example</p>
<p>I’m going to show you a very simple example of a promise with a HTTP conection. The first thing is to create an application in Angular which I think everyone knows how to do. The next thing is to create a service, you can do this step in two ways. I’m going to tell you both and you can choose which you prefer:</p>
<ol>
<li>Create a file called street-crimes2.service.ts or whatever you want to call it.</li>
<li>By using the following command in your console:</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">    ng generate service StreetCrimes
</code></pre></div><p>If you went for the second way, lucky you. You don’t have to write a lot of things later. If you used the first way, copy and paste the next text into that class:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">    <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Injectable</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;@angular/core&#39;</span>;
    <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">HttpClient</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;@angular/common/http&#39;</span>;

    <span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">Injectable</span>()
    <span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StreetCrimesService</span> {

      <span style="color:#a6e22e">constructor</span>(<span style="color:#66d9ef">private</span> <span style="color:#a6e22e">http</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">HttpClient</span> ) {}

      <span style="color:#a6e22e">search</span>(<span style="color:#a6e22e">lat</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">number</span>, <span style="color:#66d9ef">long</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">number</span>, <span style="color:#a6e22e">yearMonth</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">string</span>) {
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">http</span>
          .<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">`</span><span style="color:#e6db74">https://data.police.uk/api/crimes-street/all-crime?lat=</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">lat</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&amp;lng=</span><span style="color:#e6db74">${</span><span style="color:#66d9ef">long</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&amp;date=</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">yearMonth</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>)
          .<span style="color:#a6e22e">toPromise</span>();

      }
    }
</code></pre></div><p>Looks good, doesn’t it? Well let’s explain all this code a bit. The two lines on the top, as always, are imports of the class which we are going to use. The <code>@injectable</code> is the service’s decorator.  The constructor, as its name says, is the function which allows us to create the service. The <code>search(lat: number, long: number, yearMonth: string)</code> is our function which is going to give us the promise because in Angular 6 it is going to give us an Observable, which I’ll explain in another post. In this case, we add <code>toPromise()</code> and we’ll have a promise.</p>
<p>Now you have to go to your component. I’m going to do it in the AppComponent which is quick for me in this example. Your component should be like the following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">    <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Component</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;@angular/core&#39;</span>;
    <span style="color:#66d9ef">import</span> {<span style="color:#a6e22e">StreetCrimesService</span>} <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;./StreetCrimesService&#34;</span>;


    <span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">Component</span>({
      <span style="color:#a6e22e">selector</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;app-root&#39;</span>,
      <span style="color:#a6e22e">templateUrl</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;./app.component.html&#39;</span>,
      <span style="color:#a6e22e">styleUrls</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#39;./app.component.scss&#39;</span>]
    })
    <span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AppComponent</span> {
      <span style="color:#a6e22e">title</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;app&#39;</span>;

      <span style="color:#a6e22e">constructor</span>( <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">streetCrimesService</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">StreetCrimesService</span>){}

      <span style="color:#a6e22e">search</span>() {
        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">streetCrimesService</span>.<span style="color:#a6e22e">search</span>(<span style="color:#ae81ff">52.629729</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1.131592</span>, <span style="color:#e6db74">&#34;2018-01&#34;</span>)
          .<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">result</span>) =&gt; {
            <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">result</span>));
          })
          .<span style="color:#66d9ef">catch</span>((<span style="color:#a6e22e">error</span>) =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">error</span>));
      }

    }
</code></pre></div><p>This looks like a normal component but we add the service in the constructor of the component because we need to initialize it, if your IDE doesn’t add the import on the top, you’ll have to do it manually. As you can see in the file, I wrote the service inside the function which I’m going to call from the HTML later. I added the variables which I need for the API and after that I added two more things- two functions, one is inside the “then()” and other inside the “catch”. The first function is going to be executed when the call to the API works correctly and it gives us a result and in this case it’s going to print the result in the browser console. The second is going to be executed when the API doesn’t work correctly, that means, if you had an error in the process of the HTTPs request it will go there and print an error in the browser console .</p>
<p>After that, we have to go to the template of our component and put the function in some tags to execute it. I created the next button:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">    &lt;<span style="color:#f92672">button</span> <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">click</span><span style="color:#960050;background-color:#1e0010">)</span><span style="color:#960050;background-color:#1e0010">=</span><span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#a6e22e">search</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#960050;background-color:#1e0010">)</span><span style="color:#960050;background-color:#1e0010">&#34;</span>&gt; Buscar&lt;/<span style="color:#f92672">button</span>&gt;
</code></pre></div><p>When you press it, the promise is running, so after that you have to open your browser console and you’re going to see something like that:</p>
<p><img src="/images/promises/angular5Console.png" alt="console #incenter"></p>
<p>This was everything, I hope it was useful for someone and sorry for my English.</p>
<p>Bye</p>


      
<a href="https://jorgeancal.com/tags/angular-5"><kbd class="item-tag">Angular 5</kbd></a>

<a href="https://jorgeancal.com/tags/development"><kbd class="item-tag">development</kbd></a>

<a href="https://jorgeancal.com/tags/javascript"><kbd class="item-tag">JavaScript</kbd></a>

<a href="https://jorgeancal.com/tags/js"><kbd class="item-tag">JS</kbd></a>

<a href="https://jorgeancal.com/tags/promise"><kbd class="item-tag">Promise</kbd></a>


      
      
    </article>

    </div>


</main>

        <footer class="footer">
          <div class="container">
            <p class="copyright text-muted">@jorgeancal | Jorge Andreu Calatayud</p>
          </div>

        </footer>

        


    </body>

</html>

